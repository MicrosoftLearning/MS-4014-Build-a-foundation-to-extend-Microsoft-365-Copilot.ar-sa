# التمرين العملي 1: تكوين الاتصالات لموصل Microsoft Graph

## مستأجرو WWL - شروط الاستخدام

إذا تم تزويدك بحساب مستأجر كجزء من تقديم تدريب بقيادة مدرب، فلاحظ أن حساب المستأجر متاح لدعم الأنشطة العملية ضمن التدريب بقيادة المدرب.

يجب عدم مشاركة حسابات المستأجر أو استخدامها لأغراض خارج الأنشطة العملية. حساب المستأجر المستخدم في هذه الدورة التدريبية هو حساب مستأجر تجريبي، ولا يجوز استخدامه أو الوصول إليه بعد انتهاء الفصل ولا يمكن تمديد فترة صلاحيته.

يجب عدم تحويل حسابات المستأجر إلى اشتراك مدفوع. تظل حسابات المستأجر التي تم الحصول عليها كجزء من هذه الدورة التدريبية ملكًا لشركة Microsoft Corporation ونحتفظ بالحق في الوصول إليها واستعادة ملكيتها في أي وقت.

## الملخص

في هذا التمرين العملي ستستخدم مركز مسؤولي Microsoft 365 لإنشاء اتصال بملفات العملاء باستخدام موصل مشاركة الملفات من Microsoft.

تخيل أنك مدير خدمة العملاء في شركة Contoso، وهي شركة متوسطة الحجم. يواجه فريقك تحديات في سرعة الاستجابة وكفاءة التعامل مع استفسارات العملاء. قررت الاستفادة من مركز مسؤولي Microsoft 365 لإنشاء اتصال FileShare يتيح لموظفي خدمة العملاء الوصول السريع إلى ملفات العملاء والرجوع إليها بسهولة.

## التمرين 1: تكوين الاتصالات في مركز مسؤولي Microsoft 365

### تسجيل الدخول إلى VM

يمنحك موفر خدمة استضافة النشاط العملي كلمة مرور لحساب مسؤول MOD، وهو مسؤول المستأجر الافتراضي. لأغراض أمنية، قامت Microsoft بتكوين المستأجر التجريبي الخاص بك بحيث يتعين على جميع المستخدمين المحددين مسبقًا تغيير كلمة المرور الخاصة بهم عند تسجيل الدخول التالي. سجّل الدخول إلى <b>LON-CL1</b> باعتبارك حساب <b>المسؤول</b> المحلي الذي تم إنشاؤه بواسطة موفر استضافة نشاطك العملي باستخدام كلمة المرور <b>Pa55w.rd</b>.

### المهمة 1: منح الأذونات في بوابة Azure

<ol dir='rtl'>
    <li>انتقل إلى بوابة Azure <b>https://www.portal.azure.com</b> وسجل الدخول باستخدام بيانات الاعتماد الإدارية خاصتك. لا تحفظ كلمة المرور، وحدد <b>نعم</b> للبقاء <b> مسجلًا الدخول؟</b>.</li>
    <li>في <b>شاشة مرحبًا بك في Microsoft Azure</b> حدد <b>إلغاء</b>.</li>
    <li>حدد أيقونة القائمة المنسدلة على الجانب الأيسر من الشاشة لعرض قائمة البوابة. حدد <b>Microsoft Entra ID -> Manage -> App registrations</b>.</li>
    <li>حدد <b>تسجيل جديد</b> من شريط القائمة العلوي. تظهر <b>صفحة تسجيل التطبيق</b>. في هذه الصفحة، ادخل اسم للتطبيق؛ فلنسمي هذا التطبيق <b>Contoso Fileshare</b>. اترك خيار أنواع الحسابات المدعومة الافتراضية على النحو التالي <b>الحسابات في هذا الدليل التنظيمي فقط (Contoso فقط - حساب مستأجر واحد).</b> لا تقم بتحديد <b>عنوان إعادة التوجيه URI</b> اختياري.</li>
    <li>حدد <b>تسجيل</b>. تم إنشاء تطبيقك، وتم تعيين معرف تطبيق له. ستستخدم هذه المعلومات عند إنشاء عامل موصل Graph (GCA) في الخطوات التالية. قبل أن نقوم بإنشاء GCA، دعونا نقوم بتكوين الإعدادات الضرورية.</li>
</ol>

الخطوة التالية هي منح أذونات لعامل موصل Graph في بوابة Azure:
<ol dir='rtl'>
    <li>حدد الخيار <b>إدارة -> أذونات API</b> من القائمة اليسرى.</li>
    <li>
        <p>حدد <b>إضافة إذن -> Microsoft Graph -> أذونات التطبيق</b>، واسمح بالأذونات لواجهات برمجة التطبيقات API التالية:</p>
        <ul>
            <li>الدليل -> Directory.Read.All</li>
            <li>ExternalConnection -> ExternalConnection.ReadWrite.OwnedBy</li>
            <li>ExternalItem -> ExternalItem.ReadWrite.All</li>
        </ul>
    </li>
    <li>حدد الزر <b>إضافة أذونات</b>.</li>
    <li>اختر <b>منح موافقة المسؤول لـ Contoso</b> ثم أكد عن طريق اختيار <b>نعم</b>.</li>
</ol>


<b>ملاحظة:</b> لا تغلق علامة تبويب متصفح Edge هذه. تتطلب المهام التالية نسخ المعلومات ولصقها من بوابة Azure.

### المهمة 2: تثبيت GCA

<ol dir='rtl'>
    <li>افتح علامة تبويب متصفح Microsoft Edge جديدة. انتقل إلى عنوان URL التالي لتنزيل عامل موصل Graph: <b><a href="https://www.microsoft.com/en-us/download/details.aspx?id=104045">https://www.microsoft.com/en-us/download/details.aspx?id=104045</a></b>. حدد الزر <b>تنزيل</b>. </li>
    <li>افتح الملف <b>GcaInstaller_3.1.1.0.msi</b> واتبع المطالبات الموجودة في معالج الإعداد. </li>
    <li>في شريط <b>البحث </b>في أسفل الشاشة، أدخل <b>تكوين عامل موصل Graph</b> وحدد التطبيق من القائمة عند ظهوره.</li>
    <li>اسمح للتطبيق بإجراء تغييرات على الجهاز عن طريق اختيار <b>نعم</b>.</li>
    <li>قم بتسجيل الدخول وتسجيل GCA باستخدام حساب <b>MOD إداري</b>. يظهر تأكيد اكتمال المصادقة في متصفح Edge. يمكنك إغلاق هذه النافذة.</li>
    <li>افتح تطبيق GCA عن طريق تحديد الأيقونة في أسفل الشاشة.</li>
    <li>قم بتسمية هذا العامل <b>ContosoFiles</b>.</li>
    <li>حدد علامة التبويب Microsoft Edge لبوابة Azure (يجب أن تقرأ <b>Contoso Fileshare - Microsoft Azure</b>)، وانتقل إلى شاشة<b>نظرة عامة</b> وانسخ <b>معرف التطبيق (العميل)</b>. الصقه في تطبيق تثبيت GCA.</li>
</ol>

بعد ذلك، تحتاج إلى تعيين سر العميل لهذا التطبيق في بوابة Azure.

<ol dir='rtl'>
    <li>ارجع إلى علامة تبويب Edge بوابة Azure وانتقل إلى <b>الشهادات والأسرار</b>.</li>
    <li>حدد <b>+ سر عميل جديد</b>. أضف <b>الوصف</b> عن طريق إدخال <b>ملفات Contoso</b>. يمكنك ترك حقل انتهاء الصلاحية محددًا إلى 180 يومًا افتراضيًا.</li>
    <li>حدد <b>إضافة</b>.</li>
    <li>انسخ حقل <b>القيمة</b> للسر المخفي.</li>
    <li>ارجع إلى تطبيق عامل موصل Graph والصق القيمة في <b>حقل كلمة مرور التطبيق (سر العميل)</b> لتطبيق مُثبت GCA.</li>
    <li>حدد <b>تسجيل</b>.</li>
    <li>بمجرد اكتمال التسجيل، أغلق مُثبت التطبيق.</li>
</ol>

### المهمة 3: تنزيل ملفات المصدر من Github

لتكوين الموصل باستخدام GCA، ستحتاج إلى ملفات محلية لنظامك. 

<ol dir='rtl'>
    <li>افتح متصفح Edge جديدا وأدخل <b><a href="https://github.com/MicrosoftLearning/MS-4014-Build-a-foundation-to-extend-Microsoft-365-Copilot/tree/master/ResourceFiles">https://github.com/MicrosoftLearning/MS-4014-Build-a-foundation-to-extend-Microsoft-365-Copilot/tree/master/ResourceFiles</a></b> في شريط العناوين.</li>
    <li>حدد الملف الأول في المجلد، <b>Contoso Chai Tea market trends 2023.xls</b> لفتحه.</li>
    <li>حدد زر <b>النقاط (المزيد من إجراءات الملف)</b> في أعلى يمين الشاشة، ثم حدد <b>تنزيل</b>.</li>
    <li>كرر الخطوة الثالثة لكل ملف من الملفات المتبقية.</li>
    <li>يمكنك إغلاق هذه النافذة بمجرد اكتمال التنزيلات.</li>
    <li>استخدم مستكشف الملفات وانتقل إلى C:\ الدليل. إنشاء مجلد جديد يسمى <b>ResourceFiles</b>.</li>
    <li>افتح نافذة مستكشف ملفات جديدة وانتقل إلى مجلد <b>تنزيل</b> للوصول إلى ملفات Contoso التي قمت بتنزيلها من GitHub. انسخ هذه الملفات إلى دليل<b> C:\ResourceFiles</b> .</li>
</ol>

ستستخدم هذه الملفات كمحتوى المصدر للاتصال الذي تقوم بإنشائه في مركز المسؤولين في Microsoft.

### المهمة 4: افتح مركز المسؤولين في Microsoft

<ol dir='rtl'>
    <li>افتح علامة تبويب جديدة في متصفح Microsoft Edge. في متصفح Microsoft Edge، انتقل إلى صفحة <b>Microsoft 365 الصفحة ارئيسية</b> عن طريق إدخال عنوان URL التالي في شريط العناوين: <b><a href="https://portal.office.com">https://portal.office.com</a></b></li>
    <li>إذا طُلب منك تسجيل الدخول، فأدخل <b>اسم المستخدم</b> LON-CL1 و<b>كلمة المرور</b> اللذين قدمهما لك موفر استضافة نشاط عملي لحساب مستأجر نسخة Microsoft 365 التجريبية. يجب أن يكون اسم المستخدم بصيغة <b><a href="admin@xxxxxZZZZZZ.onmicrosoft.com">admin@xxxxxZZZZZZ.onmicrosoft.com</a></b>، حيث xxxxxZZZZZZ هو بادئة المستأجر المعينة من قبل موفر استضافة نشاطك العملي. </li>
    <li>تظهر صفحة <b>مرحبًا بك في Microsoft 365</b> في متصفح Microsoft Edge في علامة المتصفح <b>الصفحة الرئيسية | Microsoft 365</b>. هذه الصفحة هي الصفحة الرئيسية لمسؤول MOD في Microsoft 365.</li>
    <li>حدد <b>المسؤول</b> من قائمة أيقونات التطبيق التي تظهر في جزء التنقل؛ يؤدي هذا الإجراء إلى فتح <b>مركز مسؤولي Microsoft 365</b> في علامة تبويب جديدة للمتصفح.</li>
    <li>حدد <b>المسؤول</b> من قائمة أيقونات التطبيق التي تظهر في جزء التنقل؛ يؤدي هذا الإجراء إلى فتح <b>مركز مسؤولي Microsoft 365</b> في علامة تبويب جديدة للمتصفح.</li>
    <li>حدد <b>... إظهار الكل</b> لعرض قائمة التنقل الكاملة. حدد <b>الإعدادات</b> -> <b>البحث والتحليل الذكي.</b></li>
    <li>في علامة تنويب<b>نظرة عامة</b> التي تظهر، قم بالتمرير لأسفل. حدد <b>إضافة اتصالك الأول</b> من مربع<b>الموصلات</b> .</li>
</ol>


من هنا، يتم سرد قائمة بمصادر البيانات المتوفرة. نقوم بتكوين اتصال باستخدام موصل مشاركة الملفات. يتيح هذا الموصل لبحث Microsoft 365 Copilot الرجوع إلى ملفات العملاء ضمن بحث Copilot ويسمح بأوقات استجابة أسرع واستجابات أكثر دقة أثناء بحث عامل خدمة العملاء عن الإجابات.

<ol dir='rtl'>
    <li>حدد <b>مشاركة الملف</b>، ثم حدد <b>التالي</b>.</li>
    <li>أدخل <b>الاسم المعروض</b>. الاسم المعروض هو اسم فريد يتم عرضه للمستخدمين. لندخل <b>ملفات Contoso</b> في الحقل.</li>
    <li>أدخل <b>مسار المجلد.</b> لقد قمنا بتكوين ملفات العينة في الدليل التالي:
        <br>
        <b>C:\ResourceFiles</b>
    </li>
</ol>
  

هذا المسار هو الدليل الذي يتم تخزين الملفات فيه.

<ol dir='rtl'>
    <li>حدد GCA الذي أنشأناه في الخطوات السابقة (ContosoFiles) في حقل <b>عامل موصل Graph</b> إذا لم يكن الخيار الافتراضي.</li>
    <li>حدد <b>Windows</b> كنوع المصادقة، ثم أدخل <b>اسم المستخدم</b> و <b>كلمة المرور</b> LON-CLI لمصادقة Windows.</li>
    <li>حدد خانة الاختيار للسماح لـ Microsoft بإنشاء فهرس لبيانات الطرف الثالث في حساب المستأجر الخاص بك.</li>
    <li>حدد <b>إنشاء</b>.  تظهر شاشة النجاح، ويبدأ اتصالك في المزامنة. يمكنك إدخال نوع المحتوى المحدد، أو الأقسام في مؤسستك التي قد تستفيد من استخدامه، أو أمثلة لسير العمل في مربع <b>وصف الموصل</b>. على سبيل المثال:
        <br>
        <b>يحتوي هذا الموصل على معلومات موجودة في خادم مشاركة الملفات المحلي. ويتضمن ملفات تعريف العملاء وأسئلة العملاء التي قد تفيد مكتب الدعم في الإجابة على استفسارات العملاء.</b>
    </li>
    <li>حدد <b>تم</b>. يظهر اتصالك الآن في <b>علامة تبويب البحث والتحليل الذكي</b> في مركز مسؤولي Microsoft 365، ويمكن الرجوع إليه في نتائج البحث أو أثناء إنشاء عامل Microsoft 365 Copilot.</li>
</ol>
